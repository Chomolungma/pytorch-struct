{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Model"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. toctree::                                               \n",
    "   :maxdepth: 2                                       \n",
    "   :caption: Contents: \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import torch_struct\n",
    "import torch\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "matplotlib.rcParams['figure.figsize'] = (7.0, 7.0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Chain"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.LinearChainCRF "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, C = 3, 7, 2\n",
    "def show_chain(chain):\n",
    "    plt.imshow(chain.detach().sum(-1).transpose(0, 1))\n",
    "\n",
    "# batch, N, z_n, z_n_1\n",
    "log_potentials = torch.rand(batch, N, C, C)\n",
    "dist = torch_struct.LinearChainCRF(log_potentials)\n",
    "show_chain(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_chain(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "event = dist.to_event(torch.tensor([[0, 1, 0, 1, 1, 1, 0, 1]]), 2)\n",
    "show_chain(event[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Hidden Markov Model"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.HMM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, V, N, C = 10, 3, 7, 2\n",
    "\n",
    "transition = torch.rand(C, C).log_softmax(0)\n",
    "emission = torch.rand(V, C).log_softmax(0)\n",
    "init = torch.rand(C).log_softmax(0)\n",
    "observations = torch.randint(0, V, size=(batch, N))\n",
    "\n",
    "dist = torch_struct.HMM(transition, emission, init, observations)\n",
    "show_chain(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Semi-Markov"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.SemiMarkovCRF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, C, K = 3, 10, 2, 6\n",
    "def show_sm(chain):\n",
    "    plt.imshow(chain.detach().sum(1).sum(-1).transpose(0, 1))\n",
    "\n",
    "# batch, N, K, z_n, z_n_1\n",
    "log_potentials = torch.rand(batch, N, K, C, C)\n",
    "log_potentials[:, :, :3] = -1e9\n",
    "dist = torch_struct.SemiMarkovCRF(log_potentials)\n",
    "show_sm(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_sm(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Use -1 for segments.\n",
    "event = dist.to_event(torch.tensor([[0, 1, -1, 1, -1, -1, 0, 1,  1, -1, -1]]), (2, 6))\n",
    "show_sm(event[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Alignment"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.AlignmentCRF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZgAAAGbCAYAAAD5r4b7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAANMklEQVR4nO3dT6ild33H8c+3cw0xsVXBbpwJzRTEMght5CLRQCnGhdbQbLqIkCzczKZqKhaxhS5LNyJmIYUw6qZBF2MWIkUtVApddPDmD2gyCiG2ycSIU2hVuonBbxdzS2OYmXtu53zvec6d1wsG5pz7nIcvP+497/s859znVHcHANbtNzY9AADHk8AAMEJgABghMACMEBgARuxM7LTeVp07J/Z8g57Y9AAAx09319XuHwlM7kyyN7LnG3PVJQBgglNkAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYMRKgamqD1bVD6vquar6zPRQAGy/AwNTVSeSfCHJh5KcSfKRqjozPRgA222VI5j3JHmuu5/v7leSfDXJ/bNjAbDtVgnMySQvvub2pf37fk1Vna2qvaray+V1jQfAtlrbi/zd/Wh373b3bn57XXsFYFutEpiXktzxmtun9u8DgGtaJTDfTfKOqjpdVbckeSDJ12fHAmDb7Ry0QXe/WlUfS/KtJCeSfKm7nxmfDICtVt29/p3uVmdv7bu9cbXpAQCOn+6+6rOrv+QHYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGzFxNuXY7LqcMcFNwNWUAjpTAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYcGJiquqOqvlNVz1bVM1X18FEMBsB221lhm1eTfKq7n6yq30zyRFX9Y3c/OzwbAFvswCOY7n65u5/c//8vklxMcnJ6MAC226Feg6mqO5PcleTCVb52tqr2qmovubye6QDYWtXdq21Y9aYk/5zkb7r78etvu9vJ3hrGW7fa9AAAx053X/XJdaUjmKp6Q5KvJXnsoLgAQLLau8gqyReTXOzuz82PBMBxsMoRzD1JHkry/qp6ev/fHw/PBcCWO/Btyt39L/HiBQCH5C/5ARghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARuxseoCj1Jse4Bpq0wMADHAEA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjVg5MVZ2oqqeq6huTAwFwPBzmCObhJBenBgHgeFkpMFV1KsmHk5ybHQeA42LVI5jPJ/l0kl8NzgLAMXJgYKrqviQ/7e4nDtjubFXtVdVecnltAwKwnaq7r79B1d8meSjJq0luTfJbSR7v7gev/ZjdTvbWOedadGrTI1zVMqcCWE13X/Vp7MDA/NrGVX+U5C+6+77rbycwh7HMqQBWc63A+DsYAEYc6ghm5Z06gjmUZU4FsBpHMAAcKYEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwYuppyrX+na7HMsVzlGdhmrqYMwJESGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYMTOpgc4WrXpAa6q0pse4RqWuV7AdnAEA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAj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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, M = 3, 10, 10\n",
    "def show_deps(tree):\n",
    "    plt.imshow(tree.detach())\n",
    "\n",
    "log_potentials = torch.rand(batch, N, M, 3)\n",
    "dist = torch_struct.AlignmentCRF(log_potentials)\n",
    "show_deps(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).\n"
     ]
    },
    {
     "data": {
      "image/png": "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6XR3rXrfRa9guvvT3X1Td9+S5H1J/unl4gIAiZ+DAWDIJT0G0t3/kuRfRpYAcKS4ggFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEZc9AXHXtFBqzrZOfTjvlpX1Ga+4NhVO5v5AlpXbOgrk77uumuXnrDST57ZzH9fSXKublh6wko7L3xt6QkrPbm3mV97P5dnl57wEnu9/8pfcAwAXgmBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARuzOHXp/7tCv0Ll+YekJK72w30tPWOnYlUsvWG3nmc38e3xm99jSEw50/dVnl56w0nNX/MzSE1a68swzS09YaW9vb+kJL7G/9/yB73MFA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAj1gpMVV1fVfdW1der6lRV/cr0MAC227ovOPanSf6+u3+3qq5McnxwEwBHwEUDU1WvT/JrSX4vSbr7TJIzs7MA2HbrPER2a5KnkvxFVT1UVXdX1TUvvlNV3VlVJ6vq5KGvBGDrrBOY3SS/lOQL3X17ktNJPvXiO3X3Xd19ortPHPJGALbQOoF5IskT3X3/hbfvzfngAMCBLhqY7v5ekser6m0XbrojySOjqwDYeut+F9mHk9xz4TvIHk3yoblJABwFawWmu7+SxHMrAKzNT/IDMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAj1v11/UfE3tIDVtrvpRcc4OyxpRes1v+99IKVzvbZpScc6PkX3rT0hJVu3qmlJ6y2oR+TZzbwU3bl4H/3rmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARu0sPIEn2lx6w0rlzSy9YbW9Dvyza3Tu29IQDXbH/jaUnrPTs9W9desJKb7ri9NITVrruiquXnvAS//6jHx74vg39UAVg2wkMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGLFWYKrq41X1cFV9rar+qqqumh4GwHa7aGCq6sYkH0lyorvfnmQnyfumhwGw3dZ9iGw3ydVVtZvkeJLvzk0C4Ci4aGC6+ztJ/iTJY0meTPLD7v7yi+9XVXdW1cmqOnn4MwHYNus8RPaGJO9NcmuSNya5pqo+8OL7dfdd3X2iu08c/kwAts06D5G9K8m3uvup7j6b5L4kvzo7C4Btt05gHkvyjqo6XlWV5I4kp2ZnAbDt1nkO5v4k9yZ5MMlXL/yZu4Z3AbDldte5U3d/JslnhrcAcIT4SX4ARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWDEWr9NmWm99ICVOvtLT1hp/9zSCw7y7NIDDvT8zpmlJ6z0zNPfXXrCSj93/Wb+2/+NG35j6Qkv8dRz3z/wfa5gABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEdXdh3/QqqeS/MchHe6GJD84pGO9Fjhfl8b5ujTO16V5LZyvN3X3T696x0hgDlNVnezuE0vv2BbO16Vxvi6N83VpXuvny0NkAIwQGABGbENg7lp6wJZxvi6N83VpnK9L85o+Xxv/HAwA22kbrmAA2EICA8CIjQ1MVf1mVX2jqr5ZVZ9aes8mq6qbq+qfq+qRqnq4qj669KZtUFU7VfVQVf3d0ls2XVVdX1X3VtXXq+pUVf3K0ps2XVV9/MLH49eq6q+q6qqlN11uGxmYqtpJ8vkkv5XktiTvr6rbll210faSfKK7b0vyjiR/4Hyt5aNJTi09Ykv8aZK/7+5fSPKLcd5eVlXdmOQjSU5099uT7CR537KrLr+NDEySX07yze5+tLvPJPnrJO9deNPG6u4nu/vBC///o5z/4L9x2VWbrapuSvLuJHcvvWXTVdXrk/xakj9Lku4+091PL7tqK+wmubqqdpMcT/LdhfdcdpsamBuTPP5jbz8RnzDXUlW3JLk9yf3LLtl4n0vyySTnlh6yBW5N8lSSv7jwkOLdVXXN0qM2WXd/J8mfJHksyZNJftjdX1521eW3qYHhFaiqa5P8TZKPdfczS+/ZVFX1niTf7+4Hlt6yJXaT/FKSL3T37UlOJ/G86Muoqjfk/KMutyZ5Y5JrquoDy666/DY1MN9JcvOPvX3Thds4QFUdy/m43NPd9y29Z8O9M8nvVNW3c/7h11+vqr9cdtJGeyLJE939v1fF9+Z8cDjYu5J8q7uf6u6zSe5L8qsLb7rsNjUw/5bkLVV1a1VdmfNPjv3twps2VlVVzj8+fqq7P7v0nk3X3Z/u7pu6+5ac/7f1T939mvvqcl3d/b0kj1fV2y7cdEeSRxactA0eS/KOqjp+4ePzjrwGvzFid+kBq3T3XlX9YZIv5fx3X/x5dz+88KxN9s4kH0zy1ar6yoXb/qi7v7jgJo6WDye558IXfI8m+dDCezZad99fVfcmeTDnv8vzobwGf22MXxUDwIhNfYgMgC0nMACMEBgARggMACMEBoARAgPACIEBYMT/AKDXsEQ9eyKFAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_deps(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "log_potentials = torch.rand(batch, N, M, 3)\n",
    "\n",
    "# Local values must be postive for match and negative for skip.\n",
    "log_potentials[..., 0] = -log_potentials[..., 0].abs()\n",
    "log_potentials[..., 1] = log_potentials[..., 1].abs()\n",
    "log_potentials[..., 2] = -log_potentials[..., 2].abs()\n",
    "\n",
    "# Block off top rows and columns\n",
    "log_potentials[..., :2, :, 1] = 0\n",
    "log_potentials[..., :, :2, 1] = 0\n",
    "log_potentials[..., -2:, :, 1] = 0\n",
    "log_potentials[..., :, -2:, 1] = 0\n",
    "\n",
    "dist = torch_struct.AlignmentCRF(log_potentials, local=True)\n",
    "show_deps(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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UVXdluT44EwAbIDq7t1PqHpzkm8n+fXe6+T/f8xC5wGw/rq7rnd8kS2yU0leSvKFqnqqqs5V1R2vP6mqzlTVpaq6dIuzArABFlnBnE7yL0nu6+6LVfVokp9291/s8hgrGIAj4lZWMNeSXOvuizs/n0/ynoMaDIDNtGdguvuHSZ6vqnfuHLo/yZXRqQBYe3tukSVJVb07ybkktyV5NslHu/s/dznfFhnAEXGjLbKFArNfAgNwdNzKazAAsG8CA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWDEQoGpqk9W1eWq+k5VfbGqbp8eDID1tmdgqupEko8nOd3d70pyLMlD04MBsN4W3SLbSvLGqtpKcjzJD+ZGAmAT7BmY7n4hyWeTPJfkxSQ/6e5vvv68qjpTVZeq6tLBjwnAullki+ytSR5McirJ25PcUVUPv/687j7b3ae7+/TBjwnAullki+wDSb7f3S9198+TXEjy/tmxAFh3iwTmuST3VtXxqqok9ye5OjsWAOtukddgLiY5n+TJJE/vPObs8FwArLnq7oO/aNXBXxSAldTddb3j/iU/ACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPAiK2h6/5Hkn8/oGv96s71WIz7tT/u1/64X/tzFO7Xr93oN6q7D3OQfauqS919etlzrAv3a3/cr/1xv/bnqN8vW2QAjBAYAEasQ2DOLnuANeN+7Y/7tT/u1/4c6fu18q/BALCe1mEFA8AaEhgARqxsYKrqg1X1vap6pqo+vex5VllV3VlV36qqK1V1uaoeWfZM66CqjlXVU1X11WXPsuqq6i1Vdb6qvltVV6vqfcueadVV1Sd3no/fqaovVtXty57psK1kYKrqWJK/SfL7Se5O8uGqunu5U620V5L8aXffneTeJH/sfi3kkSRXlz3Emng0yde7+zeS/Gbct11V1YkkH09yurvfleRYkoeWO9XhW8nAJHlvkme6+9nufjnJl5I8uOSZVlZ3v9jdT+78+mfZfvKfWO5Uq62qTib5UJJzy55l1VXVm5P8dpK/S5Lufrm7/2u5U62FrSRvrKqtJMeT/GDJ8xy6VQ3MiSTPv+bna/E/zIVU1V1J7klycbmTrLzPJflUkleXPcgaOJXkpSRf2NlSPFdVdyx7qFXW3S8k+WyS55K8mOQn3f3N5U51+FY1MNyEqnpTki8n+UR3/3TZ86yqqnogyY+6+4llz7ImtpK8J8nfdvc9Sf47iddFd1FVb832rsupJG9PckdVPbzcqQ7fqgbmhSR3vubnkzvHuIGqekO24/JYd19Y9jwr7r4kf1BV/5bt7dffrap/WO5IK+1akmvd/b+r4vPZDg439oEk3+/ul7r750kuJHn/kmc6dKsamMeTvKOqTlXVbdl+cewrS55pZVVVZXt//Gp3//Wy51l13f3n3X2yu+/K9p+tf+zuI/e3y0V19w+TPF9V79w5dH+SK0scaR08l+Teqjq+8/y8P0fwjRFTH9d/S7r7lar6WJJvZPvdF5/v7stLHmuV3ZfkI0merqpv7xz7THd/bYkzsVn+JMljO3/hezbJR5c8z0rr7otVdT7Jk9l+l+dTOYIfG+OjYgAYsapbZACsOYEBYITAADBCYAAYITAAjBAYAEYIDAAj/gdHRClCkCFmowAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "log_potentials[..., 3, 7, 1] = 50\n",
    "dist = torch_struct.AlignmentCRF(log_potentials, local=True)\n",
    "show_deps(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZgAAAGbCAYAAAD5r4b7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAOG0lEQVR4nO3d36vkB3nH8c+TPYmbjRpttRcmocmF2AahxC6iBqQ1XmgVvfEigkKlkJuqUQTRQvEfENELEZaoNwalrClYEbWgXhRK6iaxaLIKIbH5YcS1WJPG6mazTy/2tKTJrDtbz7PfmbOvFwT2zMwOH75kz/t8Z+bMVHcHAPbaJUsPAGB/EhgARggMACMEBoARAgPAiJ2JO61Lqmfu+XdzYAM3JcnzNvSFfJecXnrBaqc3dNfJDd2VJKc2eBvbr7tr1eUz33J3krxk5J5/Jy966dILVrv2qaUXrPb83yy9YLUnn1x6wWoP/2rpBWd34j+XXrDa6Q394Yq94SEyAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMGKtwFTVm6rqR1V1f1V9ZHoUANvvnIGpqgNJPp3kzUmuT/LOqrp+ehgA222dM5hXJ7m/ux/o7pNJvpTk7bOzANh26wTmqiQPP+PrR3Yv+z+q6paqOlZVx+LjWQEuenv2kcndfSTJkSSpy8oHoQJc5NY5g3k0yTXP+Prq3csA4KzWCcx3k7y8qq6rqsuS3JzkK7OzANh253yIrLtPVdV7k3wjyYEkn+vue8eXAbDV1noOpru/luRrw1sA2Ef8Jj8AIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADCiuvf+wyerqnOg9vx+f1c7z9u8TUly6OClS09Y6fevfOHSE1b6vQ39SO6nLz+w9ISzevDRE0tPWOmXTzy99AT2QHev/ObqDAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABhR3b33d1q193e6j9WBzez8ZZfU0hNWuvzaQ0tPWOlPD1669ISz+rM/vnLpCSv97d89uPQE9kB3r/xmsZnf2QDYegIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARpwzMFV1TVV9u6ruq6p7q+rWCzEMgO22s8ZtTiX5UHffXVUvSHJXVf1jd983vA2ALXbOM5jufqy779798xNJjie5anoYANttnTOY/1VV1ya5IcmdK667Jckte7IKgK23dmCq6vlJvpzkA939+LOv7+4jSY7s3rb3bCEAW2mtV5FV1aU5E5fbu/uO2UkA7AfrvIqsknw2yfHu/sT8JAD2g3XOYG5M8u4kb6iq7+3+9xfDuwDYcud8Dqa7/ylJXYAtAOwjfpMfgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYUd17/+GTPtESWMvppQes9gcb+qP3z5cesMLpJN298h33N/QwArDtBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMGJn6QHAReySo0svWOmFr/2rpSes9It/eXzpCc/RT/dZr3MGA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAj1g5MVR2oqnuq6quTgwDYH87nDObWJMenhgCwv6wVmKq6Oslbktw2OweA/WLdM5hPJvlwktODWwDYR84ZmKp6a5Kfdfdd57jdLVV1rKqO7dk6ALbWOmcwNyZ5W1X9OMmXkryhqr7w7Bt195HuPtzdh/d4IwBb6JyB6e6PdvfV3X1tkpuTfKu73zW+DICt5vdgABixcz437u7vJPnOyBIA9hVnMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwIjzejdlgL31D0sPWOnEv7956Qkr1cG/X3rCc/3XybNe5QwGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjNhZegBwMbtr6QEr/frUny89YaWDlx9cesJznPrNqbNe5wwGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEasFZiqelFVHa2qH1bV8ap67fQwALbbuh849qkkX+/ud1TVZUkODW4CYB84Z2Cq6sokr0/yl0nS3SeTnJydBcC2W+chsuuSnEjy+aq6p6puq6ornn2jqrqlqo5V1bE9XwnA1lknMDtJXpXkM919Q5Ink3zk2Tfq7iPdfbi7D+/xRgC20DqBeSTJI9195+7XR3MmOABwVucMTHf/NMnDVfWK3YtuSnLf6CoAtt66ryJ7X5Lbd19B9kCS98xNAmA/WCsw3f29JJ5bAWBtfpMfgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYse7b9QMMeHTpASud/sWvl56wUr3gJUtPeI56/OzHyhkMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwYmfpAcDF7ImlB6z09JM/XXrCSi84dN3SE57jV/2zs17nDAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARqwVmKr6YFXdW1U/qKovVtXB6WEAbLdzBqaqrkry/iSHu/uVSQ4kuXl6GADbbd2HyHaSXF5VO0kOJfnJ3CQA9oNzBqa7H03y8SQPJXksyS+7+5vPvl1V3VJVx6rq2N7PBGDbrPMQ2YuTvD3JdUleluSKqnrXs2/X3Ue6+3B3H977mQBsm3UeIntjkge7+0R3P5XkjiSvm50FwLZbJzAPJXlNVR2qqkpyU5Ljs7MA2HbrPAdzZ5KjSe5O8v3dv3NkeBcAW25nnRt198eSfGx4CwD7iN/kB2CEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARqz1bsoAM04tPWCl00/989ITVvrVZe9YesJznK5/Pet1zmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoARAgPACIEBYITAADBCYAAYITAAjBAYAEYIDAAjBAaAEQIDwAiBAWCEwAAwQmAAGCEwAIwQGABGCAwAIwQGgBECA8AIgQFghMAAMEJgABghMACMEBgARggMACMEBoAR1d17f6dVJ5L82x7d3UuS/HyP7uti4HidH8fr/Dhe5+diOF5/2N0vXXXFSGD2UlUd6+7DS+/YFo7X+XG8zo/jdX4u9uPlITIARggMACO2ITBHlh6wZRyv8+N4nR/H6/xc1Mdr45+DAWA7bcMZDABbSGAAGLGxgamqN1XVj6rq/qr6yNJ7NllVXVNV366q+6rq3qq6delN26CqDlTVPVX11aW3bLqqelFVHa2qH1bV8ap67dKbNl1VfXD33+MPquqLVXVw6U0X2kYGpqoOJPl0kjcnuT7JO6vq+mVXbbRTST7U3dcneU2Sv3a81nJrkuNLj9gSn0ry9e7+oyR/Esftt6qqq5K8P8nh7n5lkgNJbl521YW3kYFJ8uok93f3A919MsmXkrx94U0bq7sf6+67d//8RM78479q2VWbraquTvKWJLctvWXTVdWVSV6f5LNJ0t0nu/s/ll21FXaSXF5VO0kOJfnJwnsuuE0NzFVJHn7G14/EN8y1VNW1SW5IcueySzbeJ5N8OMnppYdsgeuSnEjy+d2HFG+rqiuWHrXJuvvRJB9P8lCSx5L8sru/ueyqC29TA8P/Q1U9P8mXk3ygux9fes+mqqq3JvlZd9+19JYtsZPkVUk+0903JHkyiedFf4uqenHOPOpyXZKXJbmiqt617KoLb1MD82iSa57x9dW7l3EWVXVpzsTl9u6+Y+k9G+7GJG+rqh/nzMOvb6iqLyw7aaM9kuSR7v6fs+KjORMczu6NSR7s7hPd/VSSO5K8buFNF9ymBua7SV5eVddV1WU58+TYVxbetLGqqnLm8fHj3f2Jpfdsuu7+aHdf3d3X5sz/W9/q7ovup8t1dfdPkzxcVa/YveimJPctOGkbPJTkNVV1aPff5025CF8YsbP0gFW6+1RVvTfJN3Lm1Ref6+57F561yW5M8u4k36+q7+1e9jfd/bUFN7G/vC/J7bs/8D2Q5D0L79lo3X1nVR1NcnfOvMrznlyEbxvjrWIAGLGpD5EBsOUEBoARAgPACIEBYITAADBCYAAYITAAjPhv8PFBIJlZpAwAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_deps(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Dependency Tree"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.DependencyCRF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, N = 3, 10, 10\n",
    "def show_deps(tree):\n",
    "    plt.imshow(tree.detach())\n",
    "\n",
    "log_potentials = torch.rand(batch, N, N)\n",
    "dist = torch_struct.DependencyCRF(log_potentials)\n",
    "show_deps(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_deps(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Convert from 1-index standard format. (Head is 0)\n",
    "event = dist.to_event(torch.tensor([[2, 3, 4, 1, 0, 4]]), None)\n",
    "show_deps(event[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Non-Projective Dependency Tree"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.NonProjectiveDependencyCRF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZgAAAGbCAYAAAD5r4b7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAQV0lEQVR4nO3df6ydBX3H8e+Xe2mh5ZdVM6VF2hnEoMuGuUOQxGxinKLTxPkHGkxmtmDiVGAuRvePiX9s2UKcZnEmDWqWSNQFSTSO+Cv+WBYXRgUMQjFDEFqg2k6hWITS9rs/epcw+lx77nq/fc65fb0Skt57Dk8+eXrvffc599x7sqoCAFbaSWMPAGB1EhgAWggMAC0EBoAWAgNAi/mOg86dtr7mN2zoOPQxeelZu8aeMOj+nzx/7AmDNr14z9gTBj3wyG+NPWHQgXVT/IzMuWndlmMPGLTmF2MvmB1PPvHLeHr/vsG/yJbAzG/YEGd/4JqOQx+Tm//kurEnDHrXW9899oRBf3/j9WNPGPRnH7127AmD9lx0cOwJS5o/Y//YEwYdPDCdD6K86ItzY08YVCdNX5Dv+N4nlrxtOv92AZh5AgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALSYKDCZ+frM/HFm3puZH+oeBcDsO2pgMnMuIj4ZEW+IiAsi4u2ZeUH3MABm2yRXMBdFxL1VdV9V7Y+IL0TEW3pnATDrJgnMxojY8Yy3dy6+7//IzKsyc1tmbjv4q30rtQ+AGbVi3+Svqq1VtVBVC3OnrV+pwwIwoyYJzEMRcc4z3t60+D4AWNIkgbk1Is7LzC2ZuSYiroiIr/TOAmDWzR/tDlV1IDPfGxFfj4i5iPhMVd3VvgyAmXbUwEREVNXNEXFz8xYAVhE/yQ9AC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALSY6LcpL9faRyu2fHl/x6GPydu/de3YEwZt+NhPx54w6Kq7rxx7wqAnn5tjTxh2aOwBS1tz57qxJww655t7x54w6NDali+Nx+yUv9k19oQjzP146a/1rmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAW8x0HfWpDxE/eMddx6GNy6o6Tx54w6Ly1T4w9YdCuf3rx2BMGrZ87NPaEQU9euH/sCUt66qzp3PbojtPGnjBo9+ufGnvCsNs3j73gCL9+Yu2St7mCAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWRw1MZp6Tmd/JzLsz867MvPp4DANgtk3ygmMHIuIDVXVbZp4eET/IzG9W1d3N2wCYYUe9gqmqR6rqtsU/Px4R2yNiY/cwAGbbsr4Hk5mbI+LCiLhl4LarMnNbZm47+Pi+lVkHwMyaODCZeVpEfCkirqmqvc++vaq2VtVCVS3Mnb5+JTcCMIMmCkxmnhyH43JDVd3UOwmA1WCSZ5FlRHw6IrZX1cf6JwGwGkxyBXNpRLwzIl6TmXcs/nd58y4AZtxRn6ZcVf8eEXkctgCwivhJfgBaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoEVW1Yof9IzcUK/My1b8uMfqgY9eMvaEQYdeMp0vMX3Gt6bzlUkPrp3OX+79q3NX/nNppWz83oGxJwza+YdzY08YdP519489YdA/3zp9r/f4usv3xB0/3D/4SekKBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaJFVteIHPeXFG+tFf/fuFT/usVpzy+ljTxh09r89PvaEQS/51D1jTxh091/9ztgTBq3ZvW/sCUvKR6fzY+zg2c8de8KgX7/g1LEnDHrieXNjTzjCPV/+h9i3Z0cO3eYKBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaTByYzJzLzNsz86udgwBYHZZzBXN1RGzvGgLA6jJRYDJzU0S8MSKu750DwGox6RXMxyPigxFxqHELAKvIUQOTmW+KiJ9X1Q+Ocr+rMnNbZm47uHd6X5scgONjkiuYSyPizZn504j4QkS8JjM/9+w7VdXWqlqoqoW5M9av8EwAZs1RA1NVH66qTVW1OSKuiIhvV9WV7csAmGl+DgaAFvPLuXNVfTcivtuyBIBVxRUMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQYlm/TXnigz56Umy4afpedOyxLWMvGHbS3l+PPWHQfb963tgTBj34R2vHnjDo1F2njD1hSee+9bGxJww6ePAXY08Y9L2X/uvYEwa97B/fM/aEIxw6eenbXMEA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFvMdB336zIpdl+/vOPQxOfeF/z32hEGvvOK/xp4w6PvvXhh7wqCD731y7AmDTnro1LEnLGnz+un82L/zl2ePPWHQ7/3te8aeMOiU1+0Ze8IR8l8OLHmbKxgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaDFRYDLzrMy8MTPvycztmXlJ9zAAZtukLzj2iYj4WlW9LTPXRMS6xk0ArAJHDUxmnhkRr46IP42IqKr9ETF9L1cJwFSZ5CGyLRGxOyI+m5m3Z+b1mbn+2XfKzKsyc1tmbju4d9+KDwVgtkwSmPmIeEVEfKqqLoyIfRHxoWffqaq2VtVCVS3MnXFEfwA4wUwSmJ0RsbOqbll8+8Y4HBwAWNJRA1NVuyJiR2aev/iuyyLi7tZVAMy8SZ9F9r6IuGHxGWT3RcS7+iYBsBpMFJiquiMiFpq3ALCK+El+AFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGgxaS/rn95DmbE4ye3HPpY7Llz49gTBn3u+WePPWHQS3728NgTBv3wD7449oRBf77l8rEnLOmr/zGdrxH4wvN2jz1h0GMvOzD2hGF7Th97wREOHphb8jZXMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQIv5joOuWft0vOi8n3Uc+pjsfM5ZY08YdMHGXWNPGPTAw7899oRBl3z8L8eeMGjTN3859oQlvfD8HHvCoIfXbRh7wqC3XXTr2BMG/edHfn/sCUf4xW/4sHcFA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtJgpMZl6bmXdl5o8y8/OZeUr3MABm21EDk5kbI+L9EbFQVS+PiLmIuKJ7GACzbdKHyOYj4tTMnI+IdRHxcN8kAFaDowamqh6KiOsi4sGIeCQiHquqbzz7fpl5VWZuy8xtTz/2xMovBWCmTPIQ2XMi4i0RsSUizo6I9Zl55bPvV1Vbq2qhqhZOPnPdyi8FYKZM8hDZayPi/qraXVVPR8RNEfGq3lkAzLpJAvNgRFycmesyMyPisojY3jsLgFk3yfdgbomIGyPitoi4c/H/2dq8C4AZNz/JnarqIxHxkeYtAKwifpIfgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoMdFvU16uk+cOxgvW7+049DFZd82asScMenrNhrEnDJq7pMaeMOgFf7xj7AmDXv6Oh8aesKQvf+PisScMOvOO6fycvGXT5rEnDDrt+/eOPeEIJ+17aunbjuMOAE4gAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaCEwALQQGABaCAwALQQGgBYCA0ALgQGghcAA0EJgAGghMAC0EBgAWggMAC0EBoAWAgNAC4EBoIXAANBCYABoITAAtBAYAFoIDAAtBAaAFgIDQAuBAaCFwADQQmAAaJFVtfIHzdwdEQ+s0OGeFxF7VuhYJwLna3mcr+VxvpbnRDhf51bV84duaAnMSsrMbVW1MPaOWeF8LY/ztTzO1/Kc6OfLQ2QAtBAYAFrMQmC2jj1gxjhfy+N8LY/ztTwn9Pma+u/BADCbZuEKBoAZJDAAtJjawGTm6zPzx5l5b2Z+aOw90ywzz8nM72Tm3Zl5V2ZePfamWZCZc5l5e2Z+dewt0y4zz8rMGzPznszcnpmXjL1p2mXmtYufjz/KzM9n5iljbzrepjIwmTkXEZ+MiDdExAUR8fbMvGDcVVPtQER8oKouiIiLI+IvnK+JXB0R28ceMSM+ERFfq6qXRsTvhvP2G2Xmxoh4f0QsVNXLI2IuIq4Yd9XxN5WBiYiLIuLeqrqvqvZHxBci4i0jb5paVfVIVd22+OfH4/An/8ZxV023zNwUEW+MiOvH3jLtMvPMiHh1RHw6IqKq9lfVo+OumgnzEXFqZs5HxLqIeHjkPcfdtAZmY0TseMbbO8MXzIlk5uaIuDAibhl3ydT7eER8MCIOjT1kBmyJiN0R8dnFhxSvz8z1Y4+aZlX1UERcFxEPRsQjEfFYVX1j3FXH37QGhv+HzDwtIr4UEddU1d6x90yrzHxTRPy8qn4w9pYZMR8Rr4iIT1XVhRGxLyJ8X/Q3yMznxOFHXbZExNkRsT4zrxx31fE3rYF5KCLOecbbmxbfxxIy8+Q4HJcbquqmsfdMuUsj4s2Z+dM4/PDrazLzc+NOmmo7I2JnVf3vVfGNcTg4LO21EXF/Ve2uqqcj4qaIeNXIm467aQ3MrRFxXmZuycw1cfibY18ZedPUysyMw4+Pb6+qj429Z9pV1YeralNVbY7DH1vfrqoT7l+Xk6qqXRGxIzPPX3zXZRFx94iTZsGDEXFxZq5b/Py8LE7AJ0bMjz1gSFUdyMz3RsTX4/CzLz5TVXeNPGuaXRoR74yIOzPzjsX3/XVV3TziJlaX90XEDYv/4LsvIt418p6pVlW3ZOaNEXFbHH6W5+1xAv7aGL8qBoAW0/oQGQAzTmAAaCEwALQQGABaCAwALQQGgBYCA0CL/wE1GL+1nugUdwAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, N = 3, 10, 10\n",
    "def show_deps(tree):\n",
    "    plt.imshow(tree.detach())\n",
    "\n",
    "log_potentials = torch.rand(batch, N, N)\n",
    "dist = torch_struct.NonProjectiveDependencyCRF(log_potentials)\n",
    "show_deps(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Binary Labeled Tree"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "    .. autoclass:: torch_struct.TreeCRF"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, NT = 3, 20, 3\n",
    "def show_tree(tree):\n",
    "    t = tree.detach()\n",
    "    plt.imshow(t[ :, : , 0] + \n",
    "               2 * t[ :,:, 1] +\n",
    "               3 * t[ :,:, 2])\n",
    "\n",
    "log_potentials = torch.rand(batch, N, N, NT)\n",
    "dist = torch_struct.TreeCRF(log_potentials)\n",
    "show_tree(dist.argmax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAagAAAGbCAYAAACRXATDAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAaD0lEQVR4nO3df5DddX3v8dcrv/kRJAkVMeQitNzMpD9IuZmoV+rFYjGkDBSH2mRsxQoTscUBrdOL2ouOHWeubbFOCxVTiaDDxYzW2IyNmlSdQWcEiUyAgGBixJsESC5Ewq+QZLPv+8d+4xw25+wue97Jvs/u8zFzZr/n+/2c93nvd7+7rz3f/e75OCIEAEA1k8a6AQAA2iGgAAAlEVAAgJIIKABASQQUAKCkKWPdQDszZ02NOXOnp9R6aueslDqSNOlgf1ot9x1Kq6X+vL7Un3hVZ+YVonZerYnQV7bMzzOxVK7ExiZl7q+81xH90yan1Zp/5lMpdR7bflBP7TnUdoeVDKg5c6frhq+dk1Lr1o9cllJHko578qW0WlOf3JtWS/vy+op9+/JqHexLq+Vp09JqxYEDabU8Ne9bKHN/Zcv8PDU574dkqkl5fXlGzi/YkhTH5dXaP+/ktFrf+dKtKXUWv217x22c4gMAlERAAQBKIqAAACURUACAkggoAEBJXQWU7SW2H7W91fb1bbZPt7262X6P7dd183wAgIlj1AFle7KkmyVdJGmBpOW2FwwadqWkX0bEb0j6R0mfGu3zAQAmlm5eQS2WtDUitkXEAUlflnTpoDGXSrq9Wf6qpAvszP/4AwCMV90E1FxJrf9htaNZ13ZMRPRJ2itpTrtitlfY3mh74/O/PNhFWwCA8aDMRRIRsTIiFkXEohNnTR3rdgAAY6ybgNopaV7L/dObdW3H2J4i6VWSnu7iOQEAE0Q3AXWvpLNtn2l7mqRlktYOGrNW0hXN8uWSvhvMMQ8AGIFRvwNkRPTZvkbStyVNlrQqIh6y/QlJGyNiraRbJX3J9lZJezQQYgAADKurtyiOiHWS1g1ad0PL8kuS/rib5wAATExlLpIAAKAVAQUAKImAAgCU5IoX1Z3k2fF6X5BS66PbNqXUkaT/+TdXp9Wade/utFp+7oW0WpnipbyZflNnYU2d1r4/r1TlGXUz93/idOiZ+2zSzBPTakVf4mzSiX0p8Y18nln0mpQ6D67/jJ7fs71tY7yCAgCUREABAEoioAAAJRFQAICSCCgAQEkEFACgJAIKAFASAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEkEFACgJAIKAFASAQUAKImAAgCUREABAEqaMtYNHG2fPGthWq1rH12dVuuWD1yeVuu4x2ek1fLz+/JqTUk8vA4dSisVBw+m1cr8HS9vMm7lTmufLHOa9tSp6BOnQ5cTf/d/aX9erUQnPbo3pc7klzp/b/MKCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJow4o2/Nsf8/2w7Yfsn1tmzHn295re1Nzu6G7dgEAE0U3M8r1SfqriLjP9kxJP7a9ISIeHjTu+xFxcRfPAwCYgEb9CioinoiI+5rl5yT9RNLcrMYAABNbypzctl8n6Xcl3dNm8xtt3y/pcUkfioiHOtRYIWmFJM3Q8RltpfvC/DPSav3xw99Kq7X6Ixel1Trh53lThTtxau/YlzcVfarEqdXjQOJU9JnTl0vyjOl5xSJxOvpJeZ9n9Pfn1XrppbRamjY1r1biceGXko7XIY6HrgPK9omS/k3SdRHx7KDN90k6IyKet71U0tclnd2+x1gpaaUkneTZiUcwAKAXdXUVn+2pGginOyLia4O3R8SzEfF8s7xO0lTbp3TznACAiaGbq/gs6VZJP4mIT3cY85pmnGwvbp7v6dE+JwBg4ujmFN+bJP2ZpAdtb2rWfUTSf5GkiLhF0uWS3me7T9I+ScsiMk9AAwDGq1EHVET8QNKQf3GLiJsk3TTa5wAATFy8kwQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKSpnyHa/c2gVz0mr94YPfS6u1/to3p9Walji99KTJk9NqqehU9J6S9+2YPqvNoUMla2VO065DibUSxYGkqdUl+fjj8mrtP5BTqL/zscorKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkpnwfB7772yek1Xr7w+vTan31g0vSas3oy5uOe9ILidO0T52aVqs/awrto2GIabnHC9tptaKvL62WJk/Oq5X5dTyY9DkGU74DAHoMAQUAKImAAgCUREABAEoioAAAJRFQAICSug4o24/ZftD2Jtsb22y37X+yvdX2A7bP7fY5AQDjX9b/Qb0lIp7qsO0iSWc3t9dL+mzzEQCAjo7FKb5LJX0xBtwt6WTbpx2D5wUA9LCMgApJ623/2PaKNtvnStrecn9Hs+5lbK+wvdH2xoPan9AWAKCXZZziOy8idtp+taQNth+JiLteaZGIWClppSSd5Nnj/31VAABD6voVVETsbD7ulrRG0uJBQ3ZKmtdy//RmHQAAHXUVULZPsD3z8LKkCyVtHjRsraR3NVfzvUHS3oh4opvnBQCMf92e4jtV0prmXYCnSPo/EfEt21dLUkTcImmdpKWStkp6UdKfd/mcAIAJoKuAiohtks5ps/6WluWQ9JfdPA8AYOLhnSQAACURUACAkggoAEBJTPmOl1m7YE5arc/94jNpta669gNptWbsmp5Wa+r2Tu/w9cp5SuK3Y/Tn1ZIkJ/4uO8QU36+UJyf2lTi1uiflTR+fqmpfHfAKCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJKd9x1Lz/jDel1fqTh7+ZVutLn/zDtFqznzk+rZYTp0KP/fvTaqXrS6zVn7fP1J/XWCR+LXXoUF6tAwfzak2fnlOnv7/jJl5BAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFAChp1AFle77tTS23Z21fN2jM+bb3toy5ofuWAQATwagnLIyIRyUtlCTbkyXtlLSmzdDvR8TFo30eAMDElHWK7wJJP4uIXyTVAwBMcFlTvi+TdGeHbW+0fb+kxyV9KCIeajfI9gpJKyRphvKm0cb4sHbBnLRa39h+Y1qtZe96f1qtaYc6T339SnlS8p+X+zLnaU+U2Zfz9pnTKkmJk8f3nK6/IranSbpE0lfabL5P0hkRcY6kf5b09U51ImJlRCyKiEVTlTTXPQCgZ2X8ynCRpPsiYtfgDRHxbEQ83yyvkzTV9ikJzwkAGOcyAmq5Opzes/0a226WFzfP93TCcwIAxrmu/gZl+wRJfyDpvS3rrpakiLhF0uWS3me7T9I+ScsiYiKfUgUAjFBXARURL0iaM2jdLS3LN0m6qZvnAABMTLyTBACgJAIKAFASAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEkEFACgJAIKAFASAQUAKImAAgCUREABAErKmvId6BnvnPemtFqXPbwhrdZXPrQkrdbxP38mrVY2P/diWq14Ia+WpiT+ONy/P69Wf39aKc9InK28/+jPnMQrKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkpnwHurB2wZy0Wh/cckdarRs/8KdptSTpuCfzplbP/K3YibVi/4G8YpPyOvPUxGnaM01O+koOsat4BQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEkjCijbq2zvtr25Zd1s2xtsb2k+zurw2CuaMVtsX5HVOABgfBvpK6jbJC0ZtO56Sd+JiLMlfae5/zK2Z0v6mKTXS1os6WOdggwAgFYjCqiIuEvSnkGrL5V0e7N8u6Q/avPQt0naEBF7IuKXkjboyKADAOAI3byTxKkR8USz/KSkU9uMmStpe8v9Hc26I9heIWmFJM3Q8V20BQAYD1IukoiIkBRd1lgZEYsiYtFUFX1rDwDAMdNNQO2yfZokNR93txmzU9K8lvunN+sAABhSNwG1VtLhq/KukPTvbcZ8W9KFtmc1F0dc2KwDAGBII73M/E5JP5Q03/YO21dK+t+S/sD2Fklvbe7L9iLbn5ekiNgj6W8l3dvcPtGsAwBgSCO6SCIilnfYdEGbsRslXdVyf5WkVaPqDgAwYfFOEgCAkggoAEBJBBQAoCQCCgBQUjfvJAEg0c1n/9e0Wn+7bWVaLUn6mw+uSKt13ONOqzVl3/60WnbeGwREX19aLR1MrJVo4P0ZEvR3rsMrKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkpnwHxqFPnrUwtd4XfvHptFrvvu6v0mqd9NRzabWUNYW5JE1J/NEa/Xm1Mh1K3F8d8AoKAFASAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEkEFACgJAIKAFASAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEnDBpTtVbZ3297csu7vbT9i+wHba2yf3OGxj9l+0PYm2xszGwcAjG8jeQV1m6Qlg9ZtkPRbEfE7kn4q6cNDPP4tEbEwIhaNrkUAwEQ0bEBFxF2S9gxatz4i+pq7d0s6/Sj0BgCYwDLmJX6PpNUdtoWk9bZD0uciYmWnIrZXSFohSTN0fEJbALL8xRnnpdW6+tGvptW67apL0mpNOngordaUJ59JqxX7nFZL/XnTtHtK0lT0L3b+/LoKKNsfldQn6Y4OQ86LiJ22Xy1pg+1HmldkR2jCa6UkneTZR3+yewBAaaO+is/2uyVdLOmdEdE2UCJiZ/Nxt6Q1khaP9vkAABPLqALK9hJJfy3pkoh4scOYE2zPPLws6UJJm9uNBQBgsJFcZn6npB9Kmm97h+0rJd0kaaYGTtttsn1LM/a1ttc1Dz1V0g9s3y/pR5L+IyK+dVQ+CwDAuDPs36AiYnmb1bd2GPu4pKXN8jZJ53TVHQBgwuKdJAAAJRFQAICSCCgAQEkEFACgJAIKAFASAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEkEFACgJAIKAFBSxpTvADBiX5w/L63W/3jgh2m1vvGp89NqzX76+bRa9nFptXTgYF6t/qQp3915yndeQQEASiKgAAAlEVAAgJIIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlMeU7gJ71/d+ZkVbrM9tuTqv14fe9N63WjF0vptWa9EzeVPQ62JdUiCnfAQA9hoACAJREQAEASiKgAAAlEVAAgJKGDSjbq2zvtr25Zd3Hbe+0vam5Le3w2CW2H7W91fb1mY0DAMa3kbyCuk3Skjbr/zEiFja3dYM32p4s6WZJF0laIGm57QXdNAsAmDiGDaiIuEvSnlHUXixpa0Rsi4gDkr4s6dJR1AEATEDd/A3qGtsPNKcAZ7XZPlfS9pb7O5p1bdleYXuj7Y0Htb+LtgAA48FoA+qzkn5d0kJJT0i6sdtGImJlRCyKiEVTNb3bcgCAHjeqgIqIXRFxKCL6Jf2rBk7nDbZT0ryW+6c36wAAGNaoAsr2aS13L5O0uc2weyWdbftM29MkLZO0djTPBwCYeIZ9s1jbd0o6X9IptndI+pik820vlBSSHpP03mbsayV9PiKWRkSf7WskfVvSZEmrIuKho/JZAADGnWEDKiKWt1l9a4exj0ta2nJ/naQjLkEHAGA4vJMEAKAkAgoAUBIBBQAoiYACAJTElO8AIOljZ/23tFr/8PN/Sat13Qffn1brxC39abUmvbAvp5CZ8h0A0GMIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASQQUAKAkAgoAUBIBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASUz5DgDJPnLm4rRa/2vrqrRaf3fVn6XVmhaRU2gSU74DAHoMAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEkEFACgJAIKAFASAQUAKImAAgCUREABAEoioAAAJRFQAICSCCgAQEnDzgdle5WkiyXtjojfatatljS/GXKypGciYmGbxz4m6TlJhyT1RcSipL4BAOPcSCYsvE3STZK+eHhFRPzJ4WXbN0raO8Tj3xIRT422QQDAxDRsQEXEXbZf126bbUt6h6Tfz20LADDRdTvl++9J2hURWzpsD0nrbYekz0XEyk6FbK+QtEKSZuj4LtsCgPHhxt/4zbRaVz26Jq3WzR9+R0qdQzs6x1C3AbVc0p1DbD8vInbafrWkDbYfiYi72g1swmulJJ3k2UmT3QMAetWor+KzPUXS2yWt7jQmInY2H3dLWiNp8WifDwAwsXRzmflbJT0SETvabbR9gu2Zh5clXShpcxfPBwCYQIYNKNt3SvqhpPm2d9i+stm0TINO79l+re11zd1TJf3A9v2SfiTpPyLiW3mtAwDGs5Fcxbe8w/p3t1n3uKSlzfI2Sed02R8AYILinSQAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQUrcz6gIAesQX5p+RVuuyzRtS6vzfR57tuI1XUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJBBQAoCQCCgBQEgEFACiJgAIAlERAAQBKIqAAACURUACAkggoAEBJjoix7uEItv+fpF8MM+wUSU8dg3aOll7uv5d7l3q7/17uXert/nu5d6lu/2dExK+121AyoEbC9saIWDTWfYxWL/ffy71Lvd1/L/cu9Xb/vdy71Jv9c4oPAFASAQUAKKmXA2rlWDfQpV7uv5d7l3q7/17uXert/nu5d6kH++/Zv0EBAMa3Xn4FBQAYxwgoAEBJ5QPK9hLbj9reavv6Ntun217dbL/H9uuOfZdHsj3P9vdsP2z7IdvXthlzvu29tjc1txvGotdObD9m+8Gmt41tttv2PzX7/gHb545Fn+3Ynt+yXzfZftb2dYPGlNn/tlfZ3m17c8u62bY32N7SfJzV4bFXNGO22L7i2HX9sh7a9f/3th9pjo01tk/u8Nghj7OjrUPvH7e9s+XYWNrhsUP+fDoWOvS/uqX3x2xv6vDYMd33w4qIsjdJkyX9TNJZkqZJul/SgkFj/kLSLc3yMkmrx7rvppfTJJ3bLM+U9NM2vZ8v6Rtj3esQn8Njkk4ZYvtSSd+UZElvkHTPWPc8xHH0pAb+IbDk/pf0ZknnStrcsu7vJF3fLF8v6VNtHjdb0rbm46xmeVaR/i+UNKVZ/lS7/kdynI1R7x+X9KERHFdD/nwaq/4Hbb9R0g0V9/1wt+qvoBZL2hoR2yLigKQvS7p00JhLJd3eLH9V0gW2fQx7bCsinoiI+5rl5yT9RNLcse0q3aWSvhgD7pZ0su3TxrqpNi6Q9LOIGO7dScZMRNwlac+g1a3H9u2S/qjNQ98maUNE7ImIX0raIGnJUWu0g3b9R8T6iOhr7t4t6fRj3ddIdNj3IzGSn09H3VD9Nz8L3yHpzmPaVJLqATVX0vaW+zt05A/5X41pvhn2SppzTLoboea04+9KuqfN5jfavt/2N23/5jFtbHghab3tH9te0Wb7SL4+FSxT52/Qyvv/1Ih4oll+UtKpbcb0ytfgPRp4td3OcMfZWLmmOT25qsPp1V7Y978naVdEbOmwveq+l1Q/oHqe7RMl/Zuk6yLi2UGb79PAaadzJP2zpK8f6/6GcV5EnCvpIkl/afvNY93QK2V7mqRLJH2lzebq+/9XYuB8TE/+T4jtj0rqk3RHhyEVj7PPSvp1SQslPaGB02S9aLmGfvVUcd//SvWA2ilpXsv905t1bcfYniLpVZKePibdDcP2VA2E0x0R8bXB2yPi2Yh4vlleJ2mq7VOOcZsdRcTO5uNuSWs0cEqj1Ui+PmPtIkn3RcSuwRuq739Juw6fMm0+7m4zpvTXwPa7JV0s6Z1NyB5hBMfZMRcRuyLiUET0S/rXDj1V3/dTJL1d0upOYyru+1bVA+peSWfbPrP5TXiZpLWDxqyVdPjKpcslfbfTN8Kx1Jz7vVXSTyLi0x3GvObw38tsL9bA16NKuJ5ge+bhZQ38wXvzoGFrJb2ruZrvDZL2tpySqqLjb5CV93+j9di+QtK/txnzbUkX2p7VnIa6sFk35mwvkfTXki6JiBc7jBnJcXbMDfpb6mVq39NIfj6NpbdKeiQidrTbWHXfv8xYX6Ux3E0DV4r9VANXy3y0WfcJDRz0kjRDA6dvtkr6kaSzxrrnpq/zNHBK5gFJm5rbUklXS7q6GXONpIc0cPXP3ZL++1j33dL/WU1f9zc9Ht73rf1b0s3N1+ZBSYvGuu9Bn8MJGgicV7WsK7n/NRCiT0g6qIG/ZVypgb+lfkfSFkn/KWl2M3aRpM+3PPY9zfG/VdKfF+p/qwb+RnP4+D98te1rJa0b6jgr0PuXmmP6AQ2EzmmDe2/uH/HzqUL/zfrbDh/rLWNL7fvhbrzVEQCgpOqn+AAAExQBBQAoiYACAJREQAEASiKgAAAlEVAAgJIIKABASf8fintBfkGaT8AAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_tree(dist.marginals[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Probabilistic Context-Free Grammar"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "    .. autoclass:: torch_struct.SentCFG"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "batch, N, NT, T = 3, 20, 3, 3\n",
    "def show_prob_tree(tree):\n",
    "    t = tree.detach().sum(-1).sum(-1)\n",
    "    plt.imshow(t[ :, : , 0] + \n",
    "               2 * t[ :,:, 1] +\n",
    "               3 * t[ :,:, 2])\n",
    "\n",
    "terminals = torch.rand(batch, N, T)\n",
    "rules = torch.rand(batch, NT, NT+T,  NT+T)\n",
    "init = torch.rand(batch, NT).log_softmax(-1)\n",
    "\n",
    "dist = torch_struct.SentCFG((terminals, rules, init))\n",
    "term, rules, init = dist.argmax"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Rules\n",
    "show_prob_tree(rules[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.image.AxesImage at 0x7f1814d70da0>"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbQAAAA2CAYAAACvO2whAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAI2ElEQVR4nO3db6wcVRnH8e9PCpgAgVtqoFYCVg2KL5T2BlGRNBYQiGn9QwzExCKYSrRRTIw2ISGEVy1GTTRGg0BEQrARBaqBQBGIr6i0pIUWKP2TGmhKC6UWiQlafHwxZ5thO7N3b3e6c3b9fZLNzuycnXnOPbP7dOfPU0UEZmZmo+5dbQdgZmbWBCc0MzMbC05oZmY2FpzQzMxsLDihmZnZWHBCMzOzsTBQQpM0U9IaSVvT80RNu7clbUiP1YNs08zMrIoGuQ9N0i3A6xGxQtJyYCIifljR7s2IOHGAOM3MzHoaNKFtARZExG5Js4EnIuLsinZOaGZmdlQNmtD+ERGnpGkB+zvzXe0OAhuAg8CKiLi/Zn1LgaUAJ8D8Dx9xZIdbP7/BlTUt6+CaM5/1bYcwNDkP6fyGh2E9zXW26X2kydga/8M1qPExzXj/ZT2vRcR7qhZNmdAkPQqcXrHoBuDOcgKTtD8iDjuPJmlOROySNBd4DFgYEdt7bXdSinU9I5se5VzhK+vgmhOo7RCGJuchjYaHQTTX2ab3kSZja/wP16DGxzTj/RexPiImqxbNmOq9EXFR7XqlPZJmlw457q1Zx670vEPSE8C5QM+EZmZmNh2DXra/GliSppcAD3Q3kDQh6fg0PQv4NPDcgNs1MzN7h0ET2grgYklbgYvSPJImJd2W2nwEWCdpI/A4xTk0JzQzM2vUQBeFHE0+hzZ+fA4tDz6HdoR8Di0PPc6huVKImZmNhUYSmqRLJW2RtC3dYN29/HhJq9LytZLOamK7ZmZmHQMnNEnHAL8ALgPOAa6SdE5Xs2sp7lH7IPBTYOWg2zUzMytr4hfaecC2iNgREf8Gfgcs7mqzGLgzTd8LLEw3YpuZmTWiiYQ2B3ipNP9yeq2yTUQcBA4Ap3avSNJSSeskrXu1gcDMzOz/R1YXhUTErRExGRGTlXVNzMzMajSR0HYBZ5Tm35deq2wjaQZwMrCvgW2bmZkBzSS0p4APSXq/pOOAKykqiJSVK4pcATwWud4AZ2ZmI2nKWo5TiYiDkpYBDwPHAHdExGZJNwPrImI1cDtwl6RtwOsUSc/MzKwxrhSSg6yDa44rheTBlUKOkCuF5MGVQszMbNwNq1LI1ZJelbQhPb7RxHbNzMw6Bj6HVqoUcjHFPWhPSVpdUVF/VUQsG3R7ZmZmVYZVKcTMzOyoGvgXGtWVQj5R0e7Lki4EXgS+FxEvdTeQtBRYmmbfFGzpY/uzgNembJXv+VxA/fUhb1P2IeshKDQ3Du11toVxaG6NanIMOmsc/qqG/nlufEw1/D5Mw5l1C5pIaP34E3BPRLwl6ZsUdR0/290oIm4Fbp3OiiWtq7viZVS4D3lwH9o36vGD+9CmoVQKiYh9EfFWmr0NmN/Ads3MzA4ZSqUQSbNLs4uA5xvYrpmZ2SHDqhTyHUmLgIMUlUKuHnS7JdM6RJkp9yEP7kP7Rj1+cB9ak22lEDMzs+lwpRAzMxsLTmhmZjYWRiah9VFe63hJq9LytZLOGn6U9SSdIelxSc9J2izpuxVtFkg6UCoRdmMbsfYiaaekZ1N8h9WPVuFnaRyekTSvjTjrSDq79PfdIOkNSdd3tcluHCTdIWmvpE2l12ZKWiNpa3qeqHnvktRmq6QlVW2Otpr4fyTphbSf3CfplJr39tznhqWmDzdJ2lXaVy6veW/P769hqenDqlL8OyVtqHlvFuPQU0Rk/6C42GQ7MBc4DtgInNPV5lvAr9L0lRSltlqPvRTfbGBemj6J4gbz7j4sAP7cdqxT9GMnMKvH8suBhyju9TwfWNt2zFPsV68AZ+Y+DsCFwDxgU+m1W4DlaXo5sLLifTOBHel5Ik1PZBL/JcCMNL2yKv5+9rmW+3AT8P0+9rOe319t9qFr+Y+BG3Meh16PUfmF1k95rcUUN2wD3AsslJRNcYqI2B0RT6fpf1LcujCn3aiOisXAb6PwJHBK120bOVkIbI+Iv7cdyFQi4q8UVwiXlff5O4EvVLz1c8CaiHg9IvYDa4BLj1qgNarij4hHIuJgmn2S4h7WbNWMQT+yKQ/Yqw/p+/IrwD1DDapBo5LQqsprdSeDQ23Sh+QAcOpQopumdDj0XGBtxeJPStoo6SFJHx1qYP0J4BFJ61Opsm79jFUurqT+w5v7OACcFhG70/QrwGkVbUZlPK6h+GVfZap9rm3L0mHTO2oO+47KGHwG2BMRW2uW5z4OI5PQxoakE4E/ANdHxBtdi5+mOPz1MeDnwP3Djq8PF0TEPOAy4Nsq6nOOnFQEYBHw+4rFozAO7xDFMaGRvAdH0g0U96jeXdMk533ul8AHgI8DuykO2Y2qq+j96yzncQBGJ6FNWV6r3EbSDOBkYN9QouuTpGMpktndEfHH7uUR8UZEvJmmHwSOlTRryGH2FBG70vNe4D6Kwyll/YxVDi4Dno6IPd0LRmEckj2dw7npeW9Fm6zHQ9LVwOeBr6akfJg+9rnWRMSeiHg7Iv4L/Jrq2LIeAzj0nfklYFVdm5zHoWNUEtqU5bXSfOcKriuAx+o+IG1Ix6dvB56PiJ/UtDm9c95P0nkU45NNUpZ0gqSTOtMUJ/U3dTVbDXwtXe14PnCgdFgsJ7X/Gs19HErK+/wS4IGKNg8Dl0iaSIfDLkmvtU7SpcAPgEUR8a+aNv3sc63pOj/8Rapj6+f7q20XAS9ExMtVC3Mfh0Paviql3wfF1XMvUlwtdEN67WaKDwPAuykOH20D/gbMbTvmrvgvoDgk9AywIT0uB64DrkttlgGbKa6CehL4VNtxd/VhboptY4qzMw7lPojiP3zdDjwLTLYdd0U/TqBIUCeXXst6HCiS727gPxTnYK6lOEf8F2Ar8CgwM7WdBG4rvfea9LnYBnw9o/i3UZxb6nweOlcpvxd4sNc+l1Ef7kr7+TMUSWp2dx/S/GHfX7n0Ib3+m87+X2qb5Tj0erj0lZmZjYVROeRoZmbWkxOamZmNBSc0MzMbC05oZmY2FpzQzMxsLDihmZnZWHBCMzOzsfA/E2xropyUM8IAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Terminals\n",
    "plt.imshow(term[:1])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Autoregressive / Beam Search"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "    .. autoclass:: torch_struct.Autoregressive\n",
    "         :members: sample,sample_without_replacement,greedy_max,beam_topk\n",
    "    .. autoclass:: torch_struct.AutoregressiveModel\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "batch, N, C, H, layer = 3, 10, 4, 5, 1\n",
    "init = (torch.rand(batch, layer, H), \n",
    "        torch.rand(batch, layer, H))\n",
    "def t(a):                                                                                                                                                                    \n",
    "    return [t.transpose(0, 1) for t in a]\n",
    "\n",
    "def show_ar(chain):\n",
    "     plt.imshow(chain.detach().transpose(0, 1))\n",
    "\n",
    "class RNN_AR(torch.nn.Module):                                                                                                                                                   \n",
    "    def __init__(self):                                                                                                                                                      \n",
    "        super().__init__()                                                                                                                                                   \n",
    "        self.rnn = torch.nn.LSTM(H, H, batch_first=True)                                                                                                                     \n",
    "        self.proj = torch.nn.Linear(H, C)                                                                                                                                    \n",
    "        self.embed = torch.nn.Embedding(C, H)                                                                                                                                \n",
    "\n",
    "    def forward(self, inputs, state):                                                                                                                                        \n",
    "        inputs = self.embed(inputs)                                                                                                                                          \n",
    "        out, state = self.rnn(inputs, t(state))\n",
    "        return self.proj(out), t(state)\n",
    "    \n",
    "dist = torch_struct.Autoregressive(RNN_AR(), init, C, N)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "path = dist.greedy_argmax()\n",
    "show_ar(path[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "tensor([[-12.3654, -12.3715, -12.1309]], grad_fn=<ViewBackward>)"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dist.log_prob(path.unsqueeze(0))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAaIAAAC7CAYAAAAnpZqIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAItklEQVR4nO3dX4ilh1nH8d/j7ibbpGJFc2F2g8lFW1lKTWSI1YAXiZK0FXvbgL0owt5YTaUg1TvvpehFEZY2KhhaJM1FKdG1YKAUauw2XWs325YQa7MxkrSltrWQfz5ezAirbJyT2Tn7zJn384GBmXOGlx8vu/vdc87LOdXdAYApPzY9AIBlEyIARgkRAKOECIBRQgTAKCECYNTRdRz0urq+j+fGdRz6qr3l7T+angCwON985uV8+7uv1pXuW0uIjufG/GLds45DX7WzZ89PTwBYnDvvfeY17/PUHACjhAiAUUIEwCghAmCUEAEwSogAGCVEAIwSIgBGCREAo4QIgFFCBMAoIQJglBABMEqIABi1Uoiq6r6q+npVPVVVH173KACWY9cQVdWRJB9N8s4kp5LcX1Wn1j0MgGVY5RHRnUme6u6nu/ulJJ9M8p71zgJgKVYJ0Ykkl3+03qWd2/6XqjpdVeeq6tzLeXG/9gFwyO3bxQrdfaa7t7p761iu36/DAnDIrRKiZ5PcctnPJ3duA4CrtkqIvpjkzVV1W1Vdl+S9ST693lkALMXR3X6hu1+pqg8kOZvkSJIHu/vC2pcBsAi7hihJuvvRJI+ueQsAC+SdFQAYJUQAjBIiAEYJEQCjhAiAUUIEwCghAmCUEAEwSogAGCVEAIwSIgBGCREAo4QIgFErvfv2YXLvzbdPTwBYnG/0d17zPo+IABglRACMEiIARgkRAKOECIBRQgTAKCECYJQQATBKiAAYJUQAjBIiAEYJEQCjhAiAUUIEwCghAmCUEAEwatcQVdWDVfV8VX31WgwCYFlWeUT0F0nuW/MOABZq1xB19+eSfPcabAFggY7u14Gq6nSS00lyPDfs12EBOOT27WKF7j7T3VvdvXUs1+/XYQE45Fw1B8AoIQJg1CqXb38iyReSvLWqLlXVb61/FgBLsevFCt19/7UYAsAyeWoOgFFCBMAoIQJglBABMEqIABglRACMEiIARgkRAKOECIBRQgTAKCECYJQQATBKiAAYtW8fFX65t7z9Rzl79vw6Dn3V7r359ukJAFzGIyIARgkRAKOECIBRQgTAKCECYJQQATBKiAAYJUQAjBIiAEYJEQCjhAiAUUIEwCghAmCUEAEwSogAGCVEAIzaNURVdUtVPVZVT1bVhap64FoMA2AZVvmE1leSfKi7n6iqH0/ypar6bHc/ueZtACzAro+Iuvu57n5i5/sfJLmY5MS6hwGwDK/rNaKqujXJHUkev8J9p6vqXFWde+E7r+7POgAOvZVDVFVvTPKpJB/s7u//3/u7+0x3b3X31k0/dWQ/NwJwiK0Uoqo6lu0IPdTdj6x3EgBLsspVc5Xk40kudvdH1j8JgCVZ5RHRXUnel+Tuqjq/8/WuNe8CYCF2vXy7uz+fpK7BFgAWyDsrADBKiAAYJUQAjBIiAEYJEQCjhAiAUUIEwCghAmCUEAEwSogAGCVEAIwSIgBGCREAo4QIgFG7fgzEXnzjKzfk3ptvX8ehAThkPCICYJQQATBKiAAYJUQAjBIiAEYJEQCjhAiAUUIEwCghAmCUEAEwSogAGCVEAIwSIgBGCREAo4QIgFG7hqiqjlfVP1bVP1XVhar6o2sxDIBlWOWD8V5Mcnd3/7CqjiX5fFX9TXf/w5q3AbAAu4aouzvJD3d+PLbz1escBcByrPQaUVUdqarzSZ5P8tnufvwKv3O6qs5V1bmX8+J+7wTgkFopRN39anffnuRkkjur6m1X+J0z3b3V3VvHcv1+7wTgkHpdV8119/eSPJbkvvXMAWBpVrlq7qaqetPO929I8mtJvrbuYQAswypXzf1Mkr+sqiPZDtdfd/dn1jsLgKVY5aq5ryS54xpsAWCBvLMCAKOECIBRQgTAKCECYJQQATBKiAAYJUQAjBIiAEYJEQCjhAiAUUIEwCghAmCUEAEwSogAGFXdvf8HrXohyb/u0+F+Osm39+lYS+K87Y3ztjfO294t5dz9bHffdKU71hKi/VRV57p7a3rHpnHe9sZ52xvnbe+cO0/NATBMiAAYtQkhOjM9YEM5b3vjvO2N87Z3iz93B/41IgAOt014RATAIXagQ1RV91XV16vqqar68PSeTVBVt1TVY1X1ZFVdqKoHpjdtkqo6UlVfrqrPTG/ZFFX1pqp6uKq+VlUXq+qXpjdtgqr6vZ2/o1+tqk9U1fHpTVMObIiq6kiSjyZ5Z5JTSe6vqlOzqzbCK0k+1N2nkrwjyW87b6/LA0kuTo/YMH+a5G+7++eS/Hycv11V1Ykkv5tkq7vfluRIkvfOrppzYEOU5M4kT3X30939UpJPJnnP8KYDr7uf6+4ndr7/Qbb/UTgxu2ozVNXJJO9O8rHpLZuiqn4iya8k+XiSdPdL3f292VUb42iSN1TV0SQ3JPm34T1jDnKITiR55rKfL8U/qK9LVd2a5I4kj88u2Rh/kuT3k/zX9JANcluSF5L8+c5Tmh+rqhunRx103f1skj9O8q0kzyX5j+7+u9lVcw5yiLgKVfXGJJ9K8sHu/v70noOuqn49yfPd/aXpLRvmaJJfSPJn3X1Hkv9M4vXcXVTVT2b7GZ7bktyc5Maq+s3ZVXMOcoieTXLLZT+f3LmNXVTVsWxH6KHufmR6z4a4K8lvVNU3s/008N1V9VezkzbCpSSXuvt/HnU/nO0w8f/71ST/0t0vdPfLSR5J8svDm8Yc5BB9Mcmbq+q2qrou2y/kfXp404FXVZXt5+svdvdHpvdsiu7+g+4+2d23ZvvP2t9392L/h7qq7v73JM9U1Vt3bronyZODkzbFt5K8o6pu2Pk7e08WfJHH0ekBr6W7X6mqDyQ5m+0rSh7s7gvDszbBXUnel+Sfq+r8zm1/2N2PDm7icPudJA/t/Ifx6STvH95z4HX341X1cJInsn2l65ez4HdY8M4KAIw6yE/NAbAAQgTAKCECYJQQATBKiAAYJUQAjBIiAEYJEQCj/hsRrcUKP9QnkAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "out = dist.beam_topk(5)[:, 0]\n",
    "for i in range(3):\n",
    "    show_ar(out[i])\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "torch.Size([5, 10, 4])\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "out = dist.sample((5,))[:, 0 ]\n",
    "print(out.shape)\n",
    "for i in range(3):\n",
    "    show_ar(out[i])\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "out = dist.sample_without_replacement((5,))[:, 0]\n",
    "for i in range(3):\n",
    "    show_ar(out[i])\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Base Class"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. autoclass:: torch_struct.StructDistribution\n",
    "   :members:  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbQAAACSCAYAAAAttj/ZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAKrElEQVR4nO3df6xfd13H8eeL225zQ9iki5S2cTNUlChu46ZKZpbFMemQrCZgsiXqIJKbGKaoMbppMiJ/Tf/wVySQpat0CgxTRK+koW7ZCBIC7A47YBsd14akt5t2tGNQUWbH2z/u6XJ3/bYd+577Pfd++nwk39zz49Pzfp/c3Pvq95zP99xUFZIkrXUvGboBSZL6YKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmjBWoCX5oST3JPla9/WiU4x7Nsn+7jU7Tk1JkkbJOJ9DS/KnwLGquj3JLcBFVfUHI8Ydr6qXjtGnJEmnNW6gHQCurqonkmwEPlVVrxkxzkCTJK2ocQPtm1V1Ybcc4KmT68vGnQD2AyeA26vqH09xvBlgBuCC8/P6H3/1OS+6t9XusS+dP3QL0kg/9rrvDN3CivJnb237Nk99o6ouHrXvjIGW5F7glSN2/RGwe2mAJXmqqv7ffbQkm6rqcJIfBe4Drqmqfz9d3emfPq++sG/LaXtby970qsuGbkEaad/j+4duYUX5s7e23Vt7Hqyq6VH71p3pH1fVG0+1L8l/Jtm45JLjkVMc43D39WCSTwGXA6cNNEmSvh/jTtufBW7qlm8C/mn5gCQXJTm3W94AXAk8MmZdSZKeZ9xAux24NsnXgDd26ySZTrKzG/MTwFySh4D7WbyHZqBJknp1xkuOp1NVR4FrRmyfA97ZLX8W+Klx6kiSdCY+KUSS1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1IReAi3J9iQHkswnuWXE/nOTfLTb//kkl/RRV5Kkk8YOtCRTwPuA64DXAjcmee2yYb8OPFVVrwb+HPiTcetKkrRUH+/QtgHzVXWwqp4B7gZ2LBuzA9jdLe8BrkmSHmpLkgT0E2ibgENL1he6bSPHVNUJ4GngFcsPlGQmyVySuSePPttDa5Kks8WqmhRSVXdU1XRVTV/8iqmh25EkrSF9BNphYMuS9c3dtpFjkqwDXg4c7aG2JElAP4H2ALA1yaVJzgFuAGaXjZkFbuqW3wbcV1XVQ21JkgBYN+4BqupEkpuBfcAUsKuqHk7yXmCuqmaBO4G/TTIPHGMx9CRJ6s3YgQZQVXuBvcu23bZk+X+AX+6jliRJo6yqSSGSJL1YBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJvQRaku1JDiSZT3LLiP1vT/Jkkv3d65191JUk6aR14x4gyRTwPuBaYAF4IMlsVT2ybOhHq+rmcetJkjRKH+/QtgHzVXWwqp4B7gZ29HBcSZJesLHfoQGbgENL1heAnxkx7q1JrgIeA36nqg4tH5BkBpgBOI/zedOrLuuhvdVp3+P7h25BGqnlnzu1bVKTQv4ZuKSqXgfcA+weNaiq7qiq6aqaXs+5E2pNktSCPgLtMLBlyfrmbttzqupoVX23W90JvL6HupIkPaePQHsA2Jrk0iTnADcAs0sHJNm4ZPV64NEe6kqS9Jyx76FV1YkkNwP7gClgV1U9nOS9wFxVzQK/leR64ARwDHj7uHUlSVqqj0khVNVeYO+ybbctWb4VuLWPWpIkjeKTQiRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTegl0JLsSnIkyVdOsT9J/irJfJIvJbmij7qSJJ3U1zu0DwLbT7P/OmBr95oB3t9TXUmSgJ4Crao+DRw7zZAdwF216HPAhUk29lFbkiSY3D20TcChJesL3bbnSTKTZC7J3P/y3Qm1JklqwaqaFFJVd1TVdFVNr+fcoduRJK0hkwq0w8CWJeubu22SJPViUoE2C/xaN9vxZ4Gnq+qJCdWWJJ0F1vVxkCQfAa4GNiRZAN4DrAeoqg8Ae4E3A/PAd4B39FFXkqSTegm0qrrxDPsLeFcftSRJGmVVTQqRJOnFMtAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElN6CXQkuxKciTJV06x/+okTyfZ371u66OuJEknrevpOB8E/hq46zRj/rWq3tJTPUmSnqeXd2hV9WngWB/HkiTpxejrHdoL8YYkDwGPA79XVQ8vH5BkBpjpVo/fW3sOTLC/DcA3JlVsauOkKj1nouc3AM+vN/OTKfN8LX//Wj43mPz5/cipdqSqeqmQ5BLgE1X1kyP2vQz4XlUdT/Jm4C+ramsvhXuSZK6qpofuY6V4fmub57d2tXxusLrObyKzHKvqW1V1vFveC6xPsmEStSVJZ4eJBFqSVyZJt7ytq3t0ErUlSWeHXu6hJfkIcDWwIckC8B5gPUBVfQB4G/AbSU4A/w3cUH1d6+zPHUM3sMI8v7XN81u7Wj43WEXn19s9NEmShuSTQiRJTTDQJElNMNCAJNuTHEgyn+SWofvp05keS7bWJdmS5P4kjyR5OMm7h+6pL0nOS/KFJA915/bHQ/e0EpJMJfm3JJ8Yupe+Jfl6ki93j/ybG7qfviW5MMmeJF9N8miSNwzaz9l+Dy3JFPAYcC2wADwA3FhVjwzaWE+SXAUcB+4a9RnBtS7JRmBjVX0xyQ8CDwK/1ML3r5sZfEH3+c31wGeAd1fV5wZurVdJfheYBl7W2uPxknwdmK6qJj9YnWQ3i4813JnkHOD8qvrmUP34Dg22AfNVdbCqngHuBnYM3FNvWn8sWVU9UVVf7Ja/DTwKbBq2q37UouPd6vru1dT/QJNsBn4R2Dl0L/r+JHk5cBVwJ0BVPTNkmIGBBou//A4tWV+gkV+IZ5vuaTWXA58ftpP+dJfj9gNHgHuqqplz6/wF8PvA94ZuZIUU8C9JHuwe7deSS4Engb/pLhnvTHLBkA0ZaGpCkpcCHwN+u6q+NXQ/famqZ6vqMmAzsC1JM5eNk7wFOFJVDw7dywr6uaq6ArgOeFd3C6AV64ArgPdX1eXAfwGDzkEw0OAwsGXJ+uZum9aI7v7Sx4APVdU/DN3PSugu5dwPbB+6lx5dCVzf3We6G/j5JH83bEv9qqrD3dcjwMdZvMXRigVgYclVgz0sBtxgDLTFSSBbk1za3dS8AZgduCe9QN3EiTuBR6vqz4bup09JLk5yYbf8AyxOXPrqsF31p6purarNVXUJiz9391XVrwzcVm+SXNBNVKK7FPcLQDOzjavqP4BDSV7TbboGGHQy1iT/fMyqVFUnktwM7AOmgF2j/rTNWjXqsWRVdeewXfXqSuBXgS9395oA/rB7CPZatxHY3c3EfQnw91XV3NT2hv0w8PHuMbbrgA9X1SeHbal3vwl8qHszcBB4x5DNnPXT9iVJbfCSoySpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCf8HMdcDHDKaoT8AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "batch, N, C = 3, 7, 2\n",
    "\n",
    "# batch, N, z_n, z_n_1\n",
    "log_potentials = torch.rand(batch, N, C, C)\n",
    "dist = torch_struct.LinearChainCRF(log_potentials, lengths=torch.tensor([N-1, N, N+1]))\n",
    "show_chain(dist.argmax[0])\n",
    "plt.show()\n",
    "show_chain(dist.argmax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_chain(dist.marginals[0])\n",
    "plt.show()\n",
    "show_chain(dist.marginals[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "def show_samples(samples):\n",
    "    show_chain(samples[0, 0])\n",
    "    plt.show()\n",
    "    show_chain(samples[1, 0])\n",
    "    plt.show()\n",
    "    show_chain(samples[0, 1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbQAAACSCAYAAAAttj/ZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAKpklEQVR4nO3df6xfdX3H8efLewsTHIKUzGvbDcw6MzMN4E2dYSFkyCxq6JK5BJJNNJqbLLK5LcsGW4KZf7H9sV+Z0ZDSWTYnLqjb1TTrMGDcsqhctKiAxbvGpLewFVtEOzdZ8b0/7im5XL9tke/p9/R++nwk39zz49Pzfp/c3Pvq95zP99xUFZIkrXUvGroBSZL6YKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmjBWoCV5WZJ7knyj+3rBccY9k2RP95ofp6YkSaNknM+hJflT4HBV3ZbkZuCCqvqDEeOOVNVLxuhTkqQTGjfQ9gJXVdXjSWaAz1bVq0aMM9AkSafUuIH27ao6v1sO8OSx9VXjjgJ7gKPAbVX1j8c53hwwBzDF1OvO4bwX3JuG9TOv/d7QLUgjPfqVc4ZuQWP4Lk9+q6ouGrXvpIGW5DPAy0fs+iNg58oAS/JkVf3QfbQkG6rqQJJXAvcCV1fVf5yo7nl5Wb0+V5+wN52+dj+2Z+gWpJHe9IpLh25BY/hM3f1AVc2O2jd9sn9cVW883r4k/5VkZsUlx4PHOcaB7uu+JJ8FLgNOGGiSJP0oxp22Pw/c2C3fCPzT6gFJLkhydre8HrgCeHjMupIkPce4gXYbcE2SbwBv7NZJMptkezfmZ4GFJA8C97F8D81AkyT16qSXHE+kqg4BP3Sjq6oWgHd3y/8OvGacOpIknYxPCpEkNcFAkyQ1wUCTJDXBQJMkNcFAkyQ1wUCTJDXBQJMkNcFAkyQ1wUCTJDXBQJMkNcFAkyQ1wUCTJDXBQJMkNcFAkyQ1wUCTJDXBQJMkNcFAkyQ1wUCTJDXBQJMkNaGXQEuyNcneJItJbh6x/+wkH+v2fyHJxX3UlSTpmLEDLckU8AHgWuDVwA1JXr1q2LuAJ6vqp4E/B/5k3LqSJK3Uxzu0LcBiVe2rqqeBu4Btq8ZsA3Z2y3cDVydJD7UlSQL6CbQNwP4V60vdtpFjquoo8BRw4eoDJZlLspBk4f/4fg+tSZLOFKfVpJCqur2qZqtqdh1nD92OJGkN6SPQDgCbVqxv7LaNHJNkGngpcKiH2pIkAf0E2v3A5iSXJDkLuB6YXzVmHrixW34bcG9VVQ+1JUkCYHrcA1TV0SQ3AbuBKWBHVT2U5P3AQlXNA3cAf5tkETjMcuhJktSbsQMNoKp2AbtWbbt1xfL/Ar/aRy1JkkY5rSaFSJL0QhlokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJvQSaEm2JtmbZDHJzSP2vyPJE0n2dK9391FXkqRjpsc9QJIp4APANcAScH+S+ap6eNXQj1XVTePWkyRplD7eoW0BFqtqX1U9DdwFbOvhuJIkPW9jv0MDNgD7V6wvAa8fMe5XklwJPAr8TlXtXz0gyRwwB/CTG6bZvbCnh/Y0hDe94tKhW5BG2v1Y279XzuSfvUlNCvkUcHFVvRa4B9g5alBV3V5Vs1U1e9GFUxNqTZLUgj4C7QCwacX6xm7bs6rqUFV9v1vdDryuh7qSJD2rj0C7H9ic5JIkZwHXA/MrBySZWbF6HfBID3UlSXrW2PfQqupokpuA3cAUsKOqHkryfmChquaB30pyHXAUOAy8Y9y6kiSt1MekEKpqF7Br1bZbVyzfAtzSRy1JkkbxSSGSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCb0EmhJdiQ5mORrx9mfJH+VZDHJV5Jc3kddSZKO6esd2oeBrSfYfy2wuXvNAR/sqa4kSUBPgVZVnwMOn2DINuDOWvZ54PwkM33UliQJJncPbQOwf8X6UrftOZLMJVlIsvDEoWcm1JokqQWn1aSQqrq9qmaravaiC6eGbkeStIZMKtAOAJtWrG/stkmS1ItJBdo88PZutuPPA09V1eMTqi1JOgNM93GQJB8FrgLWJ1kC3gesA6iqDwG7gDcDi8D3gHf2UVeSpGN6CbSquuEk+wt4Tx+1JEka5bSaFCJJ0gtloEmSmmCgSZKaYKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmmCgSZKaYKBJkprQS6Al2ZHkYJKvHWf/VUmeSrKne93aR11Jko6Z7uk4Hwb+GrjzBGP+tare2lM9SZKeo5d3aFX1OeBwH8eSJOmF6Osd2vPxhiQPAo8Bv1dVD60ekGQOmOtWj0zNLO6dYH/rgW9NsN6kTfj8FidXapnfv7VtYuc3NTOJKs/hz16/fup4O1JVvVRIcjHw6ar6uRH7zgN+UFVHkrwZ+Muq2txL4Z4kWaiq2aH7OFU8v7XN81u7Wj43OL3ObyKzHKvqO1V1pFveBaxLsn4StSVJZ4aJBFqSlydJt7ylq3toErUlSWeGXu6hJfkocBWwPskS8D5gHUBVfQh4G/AbSY4C/wNcX31d6+zP7UM3cIp5fmub57d2tXxucBqdX2/30CRJGpJPCpEkNcFAkyQ1wUADkmxNsjfJYpKbh+6nTyd7LNlal2RTkvuSPJzkoSTvHbqnviT5sSRfTPJgd25/PHRPp0KSqSRfTvLpoXvpW5JvJvlq98i/haH76VuS85PcneTrSR5J8oZB+znT76ElmQIeBa4BloD7gRuq6uFBG+tJkiuBI8Cdoz4juNYlmQFmqupLSX4ceAD45Ra+f93M4HO7z2+uA/4NeG9VfX7g1nqV5HeBWeC81h6Pl+SbwGxVNfmh+CQ7WX6s4fYkZwHnVNW3h+rHd2iwBVisqn1V9TRwF7Bt4J560/pjyarq8ar6Urf8XeARYMOwXfWjlh3pVtd1r6b+B5pkI/AWYPvQvehHk+SlwJXAHQBV9fSQYQYGGiz/8tu/Yn2JRn4hnmm6p9VcBnxh2E76012O2wMcBO6pqmbOrfMXwO8DPxi6kVOkgH9J8kD3aL+WXAI8AfxNd8l4e5Jzh2zIQFMTkrwE+Djw21X1naH76UtVPVNVlwIbgS1JmrlsnOStwMGqemDoXk6hX6iqy4Frgfd0twBaMQ1cDnywqi4D/hsYdA6CgQYHgE0r1jd227RGdPeXPg58pKo+MXQ/p0J3Kec+YOvQvfToCuC67j7TXcAvJvm7YVvqV1Ud6L4eBD7J8i2OViwBSyuuGtzNcsANxkBbngSyOckl3U3N64H5gXvS89RNnLgDeKSq/mzofvqU5KIk53fLL2Z54tLXh+2qP1V1S1VtrKqLWf65u7eqfm3gtnqT5NxuohLdpbhfApqZbVxV/wnsT/KqbtPVwKCTsSb552NOS1V1NMlNwG5gCtgx6k/brFWjHktWVXcM21WvrgB+Hfhqd68J4A+7h2CvdTPAzm4m7ouAf6iq5qa2N+wngE92j7GdBv6+qv552JZ695vAR7o3A/uAdw7ZzBk/bV+S1AYvOUqSmmCgSZKaYKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmvD/rmcBKNeKCPUAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_samples(dist.sample((10,)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbQAAACSCAYAAAAttj/ZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAKrElEQVR4nO3df6xfd13H8eeL225zQ9iki5S2cTNUlChu46ZKZpbFMemQrCZgsiXqIJKbGKaoMbppMiJ/Tf/wVySQpat0CgxTRK+koW7ZCBIC7A47YBsd14akt5t2tGNQUWbH2z/u6XJ3/bYd+577Pfd++nwk39zz49Pzfp/c3Pvq95zP99xUFZIkrXUvGboBSZL6YKBJkppgoEmSmmCgSZKaYKBJkppgoEmSmjBWoCX5oST3JPla9/WiU4x7Nsn+7jU7Tk1JkkbJOJ9DS/KnwLGquj3JLcBFVfUHI8Ydr6qXjtGnJEmnNW6gHQCurqonkmwEPlVVrxkxzkCTJK2ocQPtm1V1Ybcc4KmT68vGnQD2AyeA26vqH09xvBlgBuCC8/P6H3/1OS+6t9XusS+dP3QL0kg/9rrvDN3CivJnb237Nk99o6ouHrXvjIGW5F7glSN2/RGwe2mAJXmqqv7ffbQkm6rqcJIfBe4Drqmqfz9d3emfPq++sG/LaXtby970qsuGbkEaad/j+4duYUX5s7e23Vt7Hqyq6VH71p3pH1fVG0+1L8l/Jtm45JLjkVMc43D39WCSTwGXA6cNNEmSvh/jTtufBW7qlm8C/mn5gCQXJTm3W94AXAk8MmZdSZKeZ9xAux24NsnXgDd26ySZTrKzG/MTwFySh4D7WbyHZqBJknp1xkuOp1NVR4FrRmyfA97ZLX8W+Klx6kiSdCY+KUSS1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1AQDTZLUBANNktQEA02S1IReAi3J9iQHkswnuWXE/nOTfLTb//kkl/RRV5Kkk8YOtCRTwPuA64DXAjcmee2yYb8OPFVVrwb+HPiTcetKkrRUH+/QtgHzVXWwqp4B7gZ2LBuzA9jdLe8BrkmSHmpLkgT0E2ibgENL1he6bSPHVNUJ4GngFcsPlGQmyVySuSePPttDa5Kks8WqmhRSVXdU1XRVTV/8iqmh25EkrSF9BNphYMuS9c3dtpFjkqwDXg4c7aG2JElAP4H2ALA1yaVJzgFuAGaXjZkFbuqW3wbcV1XVQ21JkgBYN+4BqupEkpuBfcAUsKuqHk7yXmCuqmaBO4G/TTIPHGMx9CRJ6s3YgQZQVXuBvcu23bZk+X+AX+6jliRJo6yqSSGSJL1YBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJvQRaku1JDiSZT3LLiP1vT/Jkkv3d65191JUk6aR14x4gyRTwPuBaYAF4IMlsVT2ybOhHq+rmcetJkjRKH+/QtgHzVXWwqp4B7gZ29HBcSZJesLHfoQGbgENL1heAnxkx7q1JrgIeA36nqg4tH5BkBpgBOI/zedOrLuuhvdVp3+P7h25BGqnlnzu1bVKTQv4ZuKSqXgfcA+weNaiq7qiq6aqaXs+5E2pNktSCPgLtMLBlyfrmbttzqupoVX23W90JvL6HupIkPaePQHsA2Jrk0iTnADcAs0sHJNm4ZPV64NEe6kqS9Jyx76FV1YkkNwP7gClgV1U9nOS9wFxVzQK/leR64ARwDHj7uHUlSVqqj0khVNVeYO+ybbctWb4VuLWPWpIkjeKTQiRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTegl0JLsSnIkyVdOsT9J/irJfJIvJbmij7qSJJ3U1zu0DwLbT7P/OmBr95oB3t9TXUmSgJ4Crao+DRw7zZAdwF216HPAhUk29lFbkiSY3D20TcChJesL3bbnSTKTZC7J3P/y3Qm1JklqwaqaFFJVd1TVdFVNr+fcoduRJK0hkwq0w8CWJeubu22SJPViUoE2C/xaN9vxZ4Gnq+qJCdWWJJ0F1vVxkCQfAa4GNiRZAN4DrAeoqg8Ae4E3A/PAd4B39FFXkqSTegm0qrrxDPsLeFcftSRJGmVVTQqRJOnFMtAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElNMNAkSU0w0CRJTTDQJElN6CXQkuxKciTJV06x/+okTyfZ371u66OuJEknrevpOB8E/hq46zRj/rWq3tJTPUmSnqeXd2hV9WngWB/HkiTpxejrHdoL8YYkDwGPA79XVQ8vH5BkBpjpVo/fW3sOTLC/DcA3JlVsauOkKj1nouc3AM+vN/OTKfN8LX//Wj43mPz5/cipdqSqeqmQ5BLgE1X1kyP2vQz4XlUdT/Jm4C+ramsvhXuSZK6qpofuY6V4fmub57d2tXxusLrObyKzHKvqW1V1vFveC6xPsmEStSVJZ4eJBFqSVyZJt7ytq3t0ErUlSWeHXu6hJfkIcDWwIckC8B5gPUBVfQB4G/AbSU4A/w3cUH1d6+zPHUM3sMI8v7XN81u7Wj43WEXn19s9NEmShuSTQiRJTTDQJElNMNCAJNuTHEgyn+SWofvp05keS7bWJdmS5P4kjyR5OMm7h+6pL0nOS/KFJA915/bHQ/e0EpJMJfm3JJ8Yupe+Jfl6ki93j/ybG7qfviW5MMmeJF9N8miSNwzaz9l+Dy3JFPAYcC2wADwA3FhVjwzaWE+SXAUcB+4a9RnBtS7JRmBjVX0xyQ8CDwK/1ML3r5sZfEH3+c31wGeAd1fV5wZurVdJfheYBl7W2uPxknwdmK6qJj9YnWQ3i4813JnkHOD8qvrmUP34Dg22AfNVdbCqngHuBnYM3FNvWn8sWVU9UVVf7Ja/DTwKbBq2q37UouPd6vru1dT/QJNsBn4R2Dl0L/r+JHk5cBVwJ0BVPTNkmIGBBou//A4tWV+gkV+IZ5vuaTWXA58ftpP+dJfj9gNHgHuqqplz6/wF8PvA94ZuZIUU8C9JHuwe7deSS4Engb/pLhnvTHLBkA0ZaGpCkpcCHwN+u6q+NXQ/famqZ6vqMmAzsC1JM5eNk7wFOFJVDw7dywr6uaq6ArgOeFd3C6AV64ArgPdX1eXAfwGDzkEw0OAwsGXJ+uZum9aI7v7Sx4APVdU/DN3PSugu5dwPbB+6lx5dCVzf3We6G/j5JH83bEv9qqrD3dcjwMdZvMXRigVgYclVgz0sBtxgDLTFSSBbk1za3dS8AZgduCe9QN3EiTuBR6vqz4bup09JLk5yYbf8AyxOXPrqsF31p6purarNVXUJiz9391XVrwzcVm+SXNBNVKK7FPcLQDOzjavqP4BDSV7TbboGGHQy1iT/fMyqVFUnktwM7AOmgF2j/rTNWjXqsWRVdeewXfXqSuBXgS9395oA/rB7CPZatxHY3c3EfQnw91XV3NT2hv0w8PHuMbbrgA9X1SeHbal3vwl8qHszcBB4x5DNnPXT9iVJbfCSoySpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCf8HMdcDHDKaoT8AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "show_samples(dist.topk(10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "torch.Size([256, 3, 7, 2, 2])\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbQAAACSCAYAAAAttj/ZAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAKrElEQVR4nO3df6xfd13H8eeL225zQ9igi5S2cTNUhChu46ZCZpbFMemQrCZisiXCIJCbGKaoMbppMiJ/Df/wVySQpat0CgxTRK+ksW7ZCBoD7A46YBsd14akt5t2tGNQUWbH2z/u6XJ3/bYd/Z77Pb2fPh/JN/f8+PS83yf3x6vfcz733FQVkiStdi8augFJkvpgoEmSmmCgSZKaYKBJkppgoEmSmmCgSZKaMFagJXlZknuSfKP7eNEJxj2bZG/3mh2npiRJo2Sc30NL8sfAkaq6PcktwEVV9fsjxh2tqheP0ackSSc1bqDtA66uqieSrAc+W1WvHjHOQJMkrahxA+3bVXVhtxzgqePry8YdA/YCx4Dbq+rvT3C8GWAG4ILz8/qfetU5p92bhvXYV84fugWdpp983feGbmFF+bW5un2Xp75VVReP2nfKQEtyL/CKEbv+ENi5NMCSPFVV/+8+WpINVXUwyU8A9wHXVNW/n6zu9M+eV1/cs+mkvenM9eZXXjZ0CzpNex7fO3QLK8qvzdXt3tr1YFVNj9q35lT/uKredKJ9Sf4zyfollxwPneAYB7uP+5N8FrgcOGmgSZL0wxh32v4scFO3fBPwD8sHJLkoybnd8jrgSuCRMetKkvQ84wba7cC1Sb4BvKlbJ8l0ku3dmNcAc0keAu5n8R6agSZJ6tUpLzmeTFUdBq4ZsX0OeE+3/G/Az4xTR5KkU/FJIZKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJvQSaEm2JtmXZD7JLSP2n5vkk93+LyS5pI+6kiQdN3agJZkCPgRcB7wWuDHJa5cNezfwVFW9CvhT4IPj1pUkaak+3qFtAearan9VPQPcDWxbNmYbsLNb3gVckyQ91JYkCegn0DYAB5asL3TbRo6pqmPA08DLlx8oyUySuSRzTx5+tofWJElnizNqUkhV3VFV01U1ffHLp4ZuR5K0ivQRaAeBTUvWN3bbRo5JsgZ4KXC4h9qSJAH9BNoDwOYklyY5B7gBmF02Zha4qVt+G3BfVVUPtSVJAmDNuAeoqmNJbgb2AFPAjqp6OMkHgLmqmgXuBP46yTxwhMXQkySpN2MHGkBV7QZ2L9t225Ll/wF+tY9akiSNckZNCpEk6XQZaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCYYaJKkJhhokqQmGGiSpCb0EmhJtibZl2Q+yS0j9r8zyZNJ9nav9/RRV5Kk49aMe4AkU8CHgGuBBeCBJLNV9ciyoZ+sqpvHrSdJ0ih9vEPbAsxX1f6qega4G9jWw3ElSXrBxn6HBmwADixZXwB+bsS4X0lyFfAY8NtVdWD5gCQzwAzAeZzPm195WQ/taQh7Ht87dAs6TX7fabWa1KSQfwQuqarXAfcAO0cNqqo7qmq6qqbXcu6EWpMktaCPQDsIbFqyvrHb9pyqOlxV3+9WtwOv76GuJEnP6SPQHgA2J7k0yTnADcDs0gFJ1i9ZvR54tIe6kiQ9Z+x7aFV1LMnNwB5gCthRVQ8n+QAwV1WzwG8muR44BhwB3jluXUmSlupjUghVtRvYvWzbbUuWbwVu7aOWJEmj+KQQSVITDDRJUhMMNElSEww0SVITDDRJUhMMNElSEww0SVITDDRJUhMMNElSEww0SVITDDRJUhMMNElSEww0SVITDDRJUhMMNElSEww0SVITDDRJUhMMNElSEww0SVITegm0JDuSHErytRPsT5K/SDKf5CtJruijriRJx/X1Du2jwNaT7L8O2Ny9ZoAP91RXkiSgp0Crqs8BR04yZBtwVy36PHBhkvV91JYkCSZ3D20DcGDJ+kK37XmSzCSZSzL3v3x/Qq1JklpwRk0Kqao7qmq6qqbXcu7Q7UiSVpFJBdpBYNOS9Y3dNkmSejGpQJsF3tHNdnwD8HRVPTGh2pKks8CaPg6S5BPA1cC6JAvA+4G1AFX1EWA38BZgHvge8K4+6kqSdFwvgVZVN55ifwHv7aOWJEmjnFGTQiRJOl0GmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQkGmiSpCQaaJKkJBpokqQm9BFqSHUkOJfnaCfZfneTpJHu712191JUk6bg1PR3no8BfAnedZMy/VNVbe6onSdLz9PIOrao+Bxzp41iSJJ2Ovt6hvRBvTPIQ8Djwu1X18PIBSWaAmW716L21a98E+1sHfGuC9SZtouc3tX5SlZ7j568385Mp83wtf/5aPjeY/Pn9+Il2pKp6qZDkEuAzVfXTI/a9BPhBVR1N8hbgz6tqcy+Fe5Jkrqqmh+5jpXh+q5vnt3q1fG5wZp3fRGY5VtV3qupot7wbWJtk3SRqS5LODhMJtCSvSJJueUtX9/AkakuSzg693ENL8gngamBdkgXg/cBagKr6CPA24NeTHAP+G7ih+rrW2Z87hm5ghXl+q5vnt3q1fG5wBp1fb/fQJEkakk8KkSQ1wUCTJDXBQAOSbE2yL8l8kluG7qdPp3os2WqXZFOS+5M8kuThJO8buqe+JDkvyReTPNSd2x8N3dNKSDKV5MtJPjN0L31L8s0kX+0e+Tc3dD99S3Jhkl1Jvp7k0SRvHLSfs/0eWpIp4DHgWmABeAC4saoeGbSxniS5CjgK3DXqdwRXuyTrgfVV9aUkPwo8CPxyC5+/bmbwBd3vb64F/hV4X1V9fuDWepXkd4Bp4CWtPR4vyTeB6apq8herk+xk8bGG25OcA5xfVd8eqh/focEWYL6q9lfVM8DdwLaBe+pN648lq6onqupL3fJ3gUeBDcN21Y9adLRbXdu9mvofaJKNwC8B24fuRT+cJC8FrgLuBKiqZ4YMMzDQYPGH34El6ws08gPxbNM9reZy4AvDdtKf7nLcXuAQcE9VNXNunT8Dfg/4wdCNrJAC/jnJg92j/VpyKfAk8FfdJePtSS4YsiEDTU1I8mLgU8BvVdV3hu6nL1X1bFVdBmwEtiRp5rJxkrcCh6rqwaF7WUE/X1VXANcB7+1uAbRiDXAF8OGquhz4L2DQOQgGGhwENi1Z39ht0yrR3V/6FPCxqvq7oftZCd2lnPuBrUP30qMrgeu7+0x3A7+Q5G+GbalfVXWw+3gI+DSLtzhasQAsLLlqsIvFgBuMgbY4CWRzkku7m5o3ALMD96QXqJs4cSfwaFX9ydD99CnJxUku7JZ/hMWJS18ftqv+VNWtVbWxqi5h8fvuvqr6tYHb6k2SC7qJSnSX4n4RaGa2cVX9B3Agyau7TdcAg07GmuSfjzkjVdWxJDcDe4ApYMeoP22zWo16LFlV3TlsV726Eng78NXuXhPAH3QPwV7t1gM7u5m4LwL+tqqam9resB8DPt09xnYN8PGq+qdhW+rdbwAf694M7AfeNWQzZ/20fUlSG7zkKElqgoEmSWqCgSZJaoKBJklqgoEmSWqCgSZJaoKBJklqwv8B+cwDHANMYTkAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Enumerate \n",
    "x,_ = dist.enumerate_support()\n",
    "print(x.shape)\n",
    "for i in range(10):\n",
    "    show_chain(x[i][0])\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.image.AxesImage at 0x7f1814a02a90>"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.imshow(dist.entropy.detach().unsqueeze(0))"
   ]
  }
 ],
 "metadata": {
  "celltoolbar": "Raw Cell Format",
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
